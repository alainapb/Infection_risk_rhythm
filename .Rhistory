zi_nb_fr_time_int,
zi_poi_null,
zi_poi_time,
zi_poi_age_time,
zi_poi_age_time_int,
# hurd_nb_null,
# hurd_nb_time,
# hurd_nb_age_time,
# hurd_nb_age_time_int,
# hurd_poi_null,
# hurd_poi_time,
# hurd_poi_age_time,
# hurd_poi_age_time_int
logLik = TRUE, base = TRUE) %>%
data.frame() %>%
dplyr::select(-dLogLik) %>%
# write.csv("aic_spore_count.csv")
knitr::kable(digits = 2)
zi_nb_fr_time_int <- zeroinfl(spore_counts ~ fr_sw + Age | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
bbmle::AICtab(zi_nb_null,
zi_nb_time,
zi_nb_fr,
zi_nb_age_time,
zi_nb_age_time_int,
zi_nb_fr_time_int,
zi_poi_null,
zi_poi_time,
zi_poi_age_time,
zi_poi_age_time_int,
# hurd_nb_null,
# hurd_nb_time,
# hurd_nb_age_time,
# hurd_nb_age_time_int,
# hurd_poi_null,
# hurd_poi_time,
# hurd_poi_age_time,
# hurd_poi_age_time_int
logLik = TRUE, base = TRUE) %>%
data.frame() %>%
dplyr::select(-dLogLik) %>%
# write.csv("aic_spore_count.csv")
knitr::kable(digits = 2)
zi_nb_age_fr<- zeroinfl(spore_counts ~ Age + fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
bbmle::AICtab(zi_nb_null,
zi_nb_time,
zi_nb_fr,
zi_nb_age_time,
zi_nb_age_time_int,
zi_nb_age_fr,
zi_poi_null,
zi_poi_time,
zi_poi_age_time,
zi_poi_age_time_int,
# hurd_nb_null,
# hurd_nb_time,
# hurd_nb_age_time,
# hurd_nb_age_time_int,
# hurd_poi_null,
# hurd_poi_time,
# hurd_poi_age_time,
# hurd_poi_age_time_int
logLik = TRUE, base = TRUE) %>%
data.frame() %>%
dplyr::select(-dLogLik) %>%
# write.csv("aic_spore_count.csv")
knitr::kable(digits = 2)
lrtest(zi_nb_null, zi_nb_time)
lrtest(zi_nb_time, zi_nb_age_time)
lrtest(zi_nb_age_time, zi_nb_age_time_int)
lrtest(zi_nb_null, zi_nb_time)
lrtest(zi_nb_null, zi_nb_fr)
lrtest(zi_nb_time, zi_nb_fr)
lrtest(zi_nb_time, zi_nb_age_time)
lrtest(zi_nb_age_time, zi_nb_age_fr)
# using function from lmtest
lrtest(zi_nb_null, zi_nb_time)
lrtest(zi_nb_null, zi_nb_fr)
lrtest(zi_nb_time, zi_nb_age_time)
lrtest(zi_nb_age_time, zi_nb_age_fr)
lrtest(zi_nb_age_time, zi_nb_age_time_int)
# is this correct?
# output agrees with previous code chunk
car::Anova(zi_nb_age_time_int, test = "Chisq")
car::Anova(zi_nb_age_fr, test = "Chisq")
car::Anova(zi_nb_fr, test = "Chisq")
age_
car::Anova(zi_nb_age_fr, test = "Chisq")
# ZI models
# negative binomial
zi_nb_null <- zeroinfl(spore_counts ~ 1 | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_time <- zeroinfl(spore_counts ~ Time_treatment | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_fr <- zeroinfl(spore_counts ~ fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_age_time <- zeroinfl(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_age_time_int <- zeroinfl(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_age_fr<- zeroinfl(spore_counts ~ Age + fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_time_fr<- zeroinfl(spore_counts ~ Time_treatment + fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
# poisson
zi_poi_null <- zeroinfl(spore_counts ~ 1 | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_time <- zeroinfl(spore_counts ~ Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time <- zeroinfl(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time_int <- zeroinfl(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
# Hurdle models
# # negative binomial
# hurd_nb_null <- hurdle(spore_counts ~ 1 | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# hurd_nb_time <- hurdle(spore_counts ~ Time_treatment | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# hurd_nb_age_time <- hurdle(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# hurd_nb_age_time_int <- hurdle(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# # poisson
# hurd_poi_null <- hurdle(spore_counts ~ 1 | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
# hurd_poi_time <- hurdle(spore_counts ~ Time_treatment | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
# hurd_poi_age_time <- hurdle(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
# hurd_poi_age_time_int <- hurdle(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
bbmle::AICtab(zi_nb_null,
zi_nb_time,
zi_nb_fr,
zi_nb_time_fr,
zi_nb_age_time,
zi_nb_age_time_int,
zi_nb_age_fr,
zi_poi_null,
zi_poi_time,
zi_poi_age_time,
zi_poi_age_time_int,
# hurd_nb_null,
# hurd_nb_time,
# hurd_nb_age_time,
# hurd_nb_age_time_int,
# hurd_poi_null,
# hurd_poi_time,
# hurd_poi_age_time,
# hurd_poi_age_time_int
logLik = TRUE, base = TRUE) %>%
data.frame() %>%
dplyr::select(-dLogLik) %>%
# write.csv("aic_spore_count.csv")
knitr::kable(digits = 2)
zi_nb_time_fr<- zeroinfl(spore_counts ~ Time_treatment * fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
# poisson
zi_poi_null <- zeroinfl(spore_counts ~ 1 | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_time <- zeroinfl(spore_counts ~ Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time <- zeroinfl(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time_int <- zeroinfl(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
bbmle::AICtab(zi_nb_null,
zi_nb_time,
zi_nb_fr,
zi_nb_time_fr,
zi_nb_age_time,
zi_nb_age_time_int,
zi_nb_age_fr,
zi_poi_null,
zi_poi_time,
zi_poi_age_time,
zi_poi_age_time_int,
# hurd_nb_null,
# hurd_nb_time,
# hurd_nb_age_time,
# hurd_nb_age_time_int,
# hurd_poi_null,
# hurd_poi_time,
# hurd_poi_age_time,
# hurd_poi_age_time_int
logLik = TRUE, base = TRUE) %>%
data.frame() %>%
dplyr::select(-dLogLik) %>%
# write.csv("aic_spore_count.csv")
knitr::kable(digits = 2)
# ZI models
# negative binomial
zi_nb_null <- zeroinfl(spore_counts ~ 1 | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_time <- zeroinfl(spore_counts ~ Time_treatment | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_fr <- zeroinfl(spore_counts ~ fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_age_time <- zeroinfl(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_age_time_int <- zeroinfl(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_age_fr<- zeroinfl(spore_counts ~ Age + fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_time_fr<- zeroinfl(spore_counts ~ Time_treatment + fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_all<- zeroinfl(spore_counts ~ Age + Time_treatment + fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
# poisson
zi_poi_null <- zeroinfl(spore_counts ~ 1 | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_time <- zeroinfl(spore_counts ~ Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time <- zeroinfl(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time_int <- zeroinfl(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
# Hurdle models
# # negative binomial
# hurd_nb_null <- hurdle(spore_counts ~ 1 | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# hurd_nb_time <- hurdle(spore_counts ~ Time_treatment | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# hurd_nb_age_time <- hurdle(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# hurd_nb_age_time_int <- hurdle(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# # poisson
# hurd_poi_null <- hurdle(spore_counts ~ 1 | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
# hurd_poi_time <- hurdle(spore_counts ~ Time_treatment | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
# hurd_poi_age_time <- hurdle(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
# hurd_poi_age_time_int <- hurdle(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
bbmle::AICtab(zi_nb_null,
zi_nb_time,
zi_nb_fr,
zi_nb_time_fr,
zi_nb_age_time,
zi_nb_age_time_int,
zi_nb_age_fr,
zi_nb_all,
zi_poi_null,
zi_poi_time,
zi_poi_age_time,
zi_poi_age_time_int,
# hurd_nb_null,
# hurd_nb_time,
# hurd_nb_age_time,
# hurd_nb_age_time_int,
# hurd_poi_null,
# hurd_poi_time,
# hurd_poi_age_time,
# hurd_poi_age_time_int
logLik = TRUE, base = TRUE) %>%
data.frame() %>%
dplyr::select(-dLogLik) %>%
# write.csv("aic_spore_count.csv")
knitr::kable(digits = 2)
zi_nb_all<- zeroinfl(spore_counts ~ Age * Time_treatment * fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
# poisson
zi_poi_null <- zeroinfl(spore_counts ~ 1 | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_time <- zeroinfl(spore_counts ~ Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time <- zeroinfl(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time_int <- zeroinfl(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
bbmle::AICtab(zi_nb_null,
zi_nb_time,
zi_nb_fr,
zi_nb_time_fr,
zi_nb_age_time,
zi_nb_age_time_int,
zi_nb_age_fr,
zi_nb_all,
zi_poi_null,
zi_poi_time,
zi_poi_age_time,
zi_poi_age_time_int,
# hurd_nb_null,
# hurd_nb_time,
# hurd_nb_age_time,
# hurd_nb_age_time_int,
# hurd_poi_null,
# hurd_poi_time,
# hurd_poi_age_time,
# hurd_poi_age_time_int
logLik = TRUE, base = TRUE) %>%
data.frame() %>%
dplyr::select(-dLogLik) %>%
# write.csv("aic_spore_count.csv")
knitr::kable(digits = 2)
summary(zi_nb_all)
lrtest(zi_nb_null, zi_nb_all)
lrtest(zi_nb_time, zi_nb_all)
lrtest(zi_nb_age_time, zi_nb_all)
car::Anova(zi_nb_all, test = "Chisq")
library(emmeans)
predict(zi_nb_time, newdata = expand.grid(Time_treatment = c("Day", "Night"), Age = 6:9), type = "response")
predict(zi_nb_time, newdata = expand.grid(Time_treatment = c("Day", "Night"), Age = 6:9), type = "count")
predict(zi_nb_time, newdata = expand.grid(Time_treatment = c("Day", "Night"), Age = 6:9), type = "zero")
# zi_nb_time
emm_response <- emmeans(zi_nb_time, "Time_treatment", mode = "response") # arithmatic mean
emm_response_lin <- emmeans(zi_nb_time, "Time_treatment", mode = "response", lin.pred = T) # geometric mean
emm_count <- emmeans(zi_nb_time, "Time_treatment", mode = "count")
# emmeans(zi_nb_time, "Time_treatment", mode = "prob0")
# zi_nb_age_time
emm_response_age_time <- emmeans(zi_nb_age_time, specs = "Time_treatment", by = "Age", mode = "response") # arithmatic mean
emm_count_age_time <- emmeans(zi_nb_age_time, specs = "Time_treatment", by = "Age", mode = "count")
cor.test(reg_data$Time_treatment, reg_data$fr_sw)
cor.test(reg_data$Age, reg_data$fr_sw)
zi_nb_all<- zeroinfl(spore_counts ~ Time_treatment * fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
# poisson
zi_poi_null <- zeroinfl(spore_counts ~ 1 | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_time <- zeroinfl(spore_counts ~ Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time <- zeroinfl(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time_int <- zeroinfl(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
bbmle::AICtab(zi_nb_null,
zi_nb_time,
zi_nb_fr,
zi_nb_time_fr,
zi_nb_age_time,
zi_nb_age_time_int,
zi_nb_age_fr,
zi_nb_all,
zi_poi_null,
zi_poi_time,
zi_poi_age_time,
zi_poi_age_time_int,
# hurd_nb_null,
# hurd_nb_time,
# hurd_nb_age_time,
# hurd_nb_age_time_int,
# hurd_poi_null,
# hurd_poi_time,
# hurd_poi_age_time,
# hurd_poi_age_time_int
logLik = TRUE, base = TRUE) %>%
data.frame() %>%
dplyr::select(-dLogLik) %>%
# write.csv("aic_spore_count.csv")
knitr::kable(digits = 2)
car::Anova(zi_nb_all, test = "Chisq")
# ZI models
# negative binomial
zi_nb_null <- zeroinfl(spore_counts ~ 1 | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_time <- zeroinfl(spore_counts ~ Time_treatment | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_fr <- zeroinfl(spore_counts ~ fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_age_time <- zeroinfl(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_age_time_int <- zeroinfl(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_age_fr<- zeroinfl(spore_counts ~ Age + fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_time_fr<- zeroinfl(spore_counts ~ Time_treatment + fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
zi_nb_all<- zeroinfl(spore_counts ~ Age * Time_treatment * fr_sw | Age + Time_treatment,
dist = "negbin", link = "logit", data = reg_data)
# poisson
zi_poi_null <- zeroinfl(spore_counts ~ 1 | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_time <- zeroinfl(spore_counts ~ Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time <- zeroinfl(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
zi_poi_age_time_int <- zeroinfl(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
dist = "poisson", link = "logit", data = reg_data)
# Hurdle models
# # negative binomial
# hurd_nb_null <- hurdle(spore_counts ~ 1 | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# hurd_nb_time <- hurdle(spore_counts ~ Time_treatment | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# hurd_nb_age_time <- hurdle(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# hurd_nb_age_time_int <- hurdle(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
#        dist = "negbin", link = "logit", data = reg_data)
# # poisson
# hurd_poi_null <- hurdle(spore_counts ~ 1 | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
# hurd_poi_time <- hurdle(spore_counts ~ Time_treatment | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
# hurd_poi_age_time <- hurdle(spore_counts ~ Age + Time_treatment | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
# hurd_poi_age_time_int <- hurdle(spore_counts ~ Age * Time_treatment | Age + Time_treatment,
#        dist = "poisson", link = "logit", data = reg_data)
bbmle::AICtab(zi_nb_null,
zi_nb_time,
zi_nb_fr,
zi_nb_time_fr,
zi_nb_age_time,
zi_nb_age_time_int,
zi_nb_age_fr,
zi_nb_all,
zi_poi_null,
zi_poi_time,
zi_poi_age_time,
zi_poi_age_time_int,
# hurd_nb_null,
# hurd_nb_time,
# hurd_nb_age_time,
# hurd_nb_age_time_int,
# hurd_poi_null,
# hurd_poi_time,
# hurd_poi_age_time,
# hurd_poi_age_time_int
logLik = TRUE, base = TRUE) %>%
data.frame() %>%
dplyr::select(-dLogLik) %>%
# write.csv("aic_spore_count.csv")
knitr::kable(digits = 2)
# using function from lmtest
lrtest(zi_nb_null, zi_nb_time)
lrtest(zi_nb_null, zi_nb_fr)
lrtest(zi_nb_time, zi_nb_age_time)
lrtest(zi_nb_age_time, zi_nb_age_fr)
lrtest(zi_nb_age_time, zi_nb_age_time_int)
lrtest(zi_nb_null, zi_nb_all)
lrtest(zi_nb_time, zi_nb_all) # *0.05
lrtest(zi_nb_age_time, zi_nb_all) # * 0.04
# is this correct?
# output agrees with previous code chunk
car::Anova(zi_nb_age_time_int, test = "Chisq")
car::Anova(zi_nb_all, test = "Chisq")
summary(reg_data)
predict(zi_nb_all, newdata = expand.grid(Time_treatment = c("Day", "Night"), Age = 6:9, fr_sw = seq(-0.5, 0.8, .2)), type = "response")
time
emm_response
# zi_nb_time
emm_response <- emmeans(zi_nb_all, "Time_treatment", mode = "response") # arithmatic mean
emm_response
# zi_nb_age_time
emm_response_all <- emmeans(zi_nb_all, specs = "Time_treatment", by = "Age", mode = "response") # arithmatic mean
emm_response_all
# zi_nb_age_time
emm_response_all <- emmeans(zi_nb_all, specs = "Time_treatment", by = "fr_sw", mode = "response") # arithmatic mean
emm_response_all
# zi_nb_age_time
emm_response_all <- emmeans(zi_nb_all, specs = c("Time_treatment", "Age"), by = "fr_sw", mode = "response") # arithmatic mean
emm_response_all
emm_count_all <- emmeans(zi_nb_all, specs = c("Time_treatment", "Age"), by = "fr_sw", mode = "count")
emm_count_all
model.matrix(zi_nb_all) %>% unique()
model.matrix(zi_nb_age_time) %>% unique()
model.matrix(zi_nb_all) %>% unique()
contrast(emm_response_all, spec = "pairwise", by = "Age")
contrast(emm_response_all, spec = "pairwise", by = c("Age", "Time_treatment"))
contrast(emm_response_all, spec = "pairwise", by = c("Age", "fr_sw"))
emmip(emm_response_all, ~ Age | Time_treatment, CIs = TRUE) +
geom_point(aes(x = Age, y = spore_counts), data = reg_data, pch = 2, color = "blue")
emmip(emm_response_all, spore_counts ~ Age * fr_sw | Time_treatment, CIs = TRUE) +
geom_point(aes(x = Age, y = spore_counts), data = reg_data, pch = 2, color = "blue")
emmip(emm_response_all,~ Age * fr_sw | Time_treatment, CIs = TRUE) +
geom_point(aes(x = Age, y = spore_counts), data = reg_data, pch = 2, color = "blue")
emmip(emm_response_all,~ Age * fr_sw | Age + Time_treatment, CIs = TRUE) +
geom_point(aes(x = Age, y = spore_counts), data = reg_data, pch = 2, color = "blue")
emmip(emm_response_all,~ fr_sw | Age + Time_treatment, CIs = TRUE) +
geom_point(aes(x = Age, y = spore_counts), data = reg_data, pch = 2, color = "blue")
emmip(emm_response_all,~ fr_sw | Age + Time_treatment, CIs = TRUE)
emmip(emm_response_all,~ Age + fr_sw | Age + Time_treatment, CIs = TRUE)
emmip(emm_response_all,~ Age * fr_sw | Age + Time_treatment, CIs = TRUE)
emmip(emm_response_all,~ Age + fr_sw + Time_treatment | Age + Time_treatment, CIs = TRUE)
emmip(emm_response_all,~ fr_sw  | Age + Time_treatment, CIs = TRUE)
emmip(emm_response_all,~ fr_sw | Age + Time_treatment, CIs = TRUE)
emmip(emm_response_all,~ fr_sw | Age + Time_treatment, CIs = TRUE) +
geom_point(aes(x = fr_sw, y = spore_counts), data = reg_data, pch = 2, color = "blue")
emmip(emm_response_all,~ fr_sw | Time_treatment, CIs = TRUE) +
geom_point(aes(x = fr_sw, y = spore_counts), data = reg_data, pch = 2, color = "blue")
summary(contrast(emm_response_all, "revpairwise"))
confint(contrast(emm_response_all, "revpairwise")) # night - day for response
# count
cont_count_all <- contrast(emm_count_all, "revpairwise") # night - day for count
summary(cont_count_all)
confint(cont_count_all)
summary(contrast(emm_response_all, "revpairwise"))
summary(cont_count_all)
check<-as.data.frame(predict(zi_nb_all, newdata = expand.grid(Time_treatment = c("Day", "Night"), Age = 6:9, fr_sw = seq(-0.5, 0.8, .2)), type = "response"))
check
View(check)
View(newdata)
predict(zi_nb_all, newdata = expand.grid(Time_treatment = c("Day", "Night"), Age = 6:9, fr_sw = seq(-0.5, 0.8, .2)), type = "response")
#predict(zi_nb_time, newdata = expand.grid(Time_treatment = c("Day", "Night"), Age = 6:9), type = "count")
#predict(zi_nb_time, newdata = expand.grid(Time_treatment = c("Day", "Night"), Age = 6:9), type = "zero")
# zi_nb_age_time
emm_response_all <- emmeans(zi_nb_all, specs = c("Time_treatment", "Age"), by = "fr_sw", mode = "response") # arithmatic mean
emm_count_all <- emmeans(zi_nb_all, specs = c("Time_treatment", "Age"), by = "fr_sw", mode = "count")
emm_response_all
emm_count_all
emm_count_all <- emmeans(zi_nb_all, specs = "Time_treatment", by = c("Age, fr_sw"), mode = "count")
emm_count_all <- emmeans(zi_nb_all, specs = "Time_treatment", by = c("Age", "fr_sw"), mode = "count")
emm_count_all
emmip(emm_count_all,~ fr_sw | Time_treatment, CIs = TRUE) +
geom_point(aes(x = fr_sw, y = spore_counts), data = reg_data, pch = 2, color = "blue")
contrast(emm_response_all, spec = "pairwise", by = c("Age", "fr_sw"))
contrast(emm_count_all, spec = "pairwise", by = c("Age", "fr_sw"))
contrast(emm_response_all, spec = "pairwise", by = c("Age", "fr_sw"))
contrast(emm_count_all, spec = "pairwise", by = c("Age", "fr_sw"))
