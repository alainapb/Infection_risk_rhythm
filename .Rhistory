ggplot(aes(x=Age, y=spore_counts, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
geom_point()+
geom_smooth(lm)
#infection intensity
life %>%
filter(Time_treatment == "Exposed"| Sex == "F") %>%
ggplot(aes(x=Age, y=spore_counts, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
geom_point()+
geom_smooth(method="lm")
#infection intensity
life %>%
filter(Time_treatment == "Exposed"| Sex == "F") %>%
ggplot(aes(x=Age, y=spore_counts, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
geom_point()+
geom_smooth(method="lm")+
theme_bw()
#infection intensity
life %>%
filter(Time_treatment == "Exposed"| Sex == "F") %>%
ggplot(aes(x=Age, y=spore_counts, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
geom_jitter()+
geom_smooth(method="lm")+
theme_bw()
#infection intensity
life %>%
filter(Time_treatment == "Exposed"| Sex == "F") %>%
ggplot(aes(x=Age, y=spore_counts, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
geom_jitter(width=.5)+
geom_smooth(method="lm")+
theme_bw()
#infection intensity
life %>%
filter(Time_treatment == "Exposed"| Sex == "F") %>%
ggplot(aes(x=Age, y=spore_counts, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
geom_jitter(width=.25)+
geom_smooth(method="lm")+
theme_bw()
#infection intensity
life %>%
filter(Time_treatment == "Exposed"| Sex == "F") %>%
ggplot(aes(x=Age, y=spore_counts, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
geom_jitter(width=.25, height = .1)+
geom_smooth(method="lm")+
theme_bw()
#infection intensity
life %>%
filter(Time_treatment == "Exposed"| Sex == "F") %>%
ggplot(aes(x=Age, y=spore_counts, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
geom_jitter(width=.25)+
geom_smooth(method="lm")+
theme_bw()
#infection intensity
life %>%
filter(Time_treatment == "Exposed"| Sex == "F") %>%
ggplot(aes(x=Age, y=spore_counts, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
#geom_jitter(width=.25)+
geom_point()+
geom_smooth(method="lm")+
theme_bw()
#total offspring
all.data %>%
#filter(infected != "NA") %>%     #removes controls
ggplot(aes(x=Time_treatment, y=total_offspring, fill=as.factor(infected)))+
geom_boxplot()+
facet_grid(~Age)
#total offspring
all.data %>%
filter(Sex == "F") %>%
#filter(infected != "NA") %>%     #removes controls
ggplot(aes(x=Time_treatment, y=total_offspring, fill=as.factor(infected)))+
geom_boxplot()+
facet_grid(~Age)
#age at first clutch
all.data %>%
filter(Sex == "F") %>%
filter(infected != "NA") %>%     #removes controls
ggplot(aes(x=as.factor(Age), y=age_at_first_clutch, fill=as.factor(infected)))+
geom_violin()+
facet_grid(~Time_treatment)
#age at first clutch
all.data %>%
filter(Sex == "F") %>%
filter(infected != "NA") %>%     #removes controls
ggplot(aes(x=Time_treatment, y=age_at_first_clutch, fill=as.factor(infected)))+
geom_violin()+
facet_grid(~Age)
#age at first clutch
all.data %>%
filter(Sex == "F") %>%
filter(infected != "NA") %>%     #removes controls
ggplot(aes(x=Time_treatment, y=age_at_first_clutch, fill=as.factor(infected)))+
geom_boxplot()+
facet_grid(~Age)
#age at first clutch
all.data %>%
filter(Sex == "F") %>%
#filter(infected != "NA") %>%     #removes controls
ggplot(aes(x=Time_treatment, y=age_at_first_clutch, fill=as.factor(infected)))+
geom_boxplot()+
facet_grid(~Age)
all.data %>%
filter(Sex == "F")%>%
ggplot()+
geom_boxplot(aes(x=as.factor(Age), y=fr_sw, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
facet_grid(.~Exposed.Control)+
theme_bw()
all.data %>%
filter(Sex == "F")%>%
ggplot()+
geom_jitter(aes(x=Time_treatment, y=fr_sw, color=Exposed.Control))+
scale_color_manual(values=c("black", "limegreen"))+
facet_grid(.~Age)+
theme_bw()
all.data %>%
filter(Sex == "F")%>%
ggplot()+
geom_jitter(aes(x=Time_treatment, y=fr_sw, color=infected))+
scale_color_manual(values=c("black", "limegreen"))+
facet_grid(.~Age)+
theme_bw()
all.data %>%
filter(Sex == "F")%>%
ggplot()+
geom_jitter(aes(x=Time_treatment, y=fr_sw, color=as.factor(infected)))+
scale_color_manual(values=c("black", "limegreen"))+
facet_grid(.~Age)+
theme_bw()
all.data %>%
filter(Sex == "F")%>%
ggplot()+
geom_jitter(aes(x=Time_treatment, y=fr_sw, color=as.factor(infected)))+
scale_color_manual(values=c("black", "limegreen", "grey"))+
facet_grid(.~Age)+
theme_bw()
all.data %>%
filter(Sex == "F")%>%
ggplot(aes(x=Time_treatment, y=fr_sw, color=as.factor(infected)))+
geom_jitter()+
scale_color_manual(values=c("black", "limegreen", "grey"))+
facet_grid(.~Age)+
theme_bw()
all.data %>%
filter(Sex == "F")%>%
ggplot(aes(x=Time_treatment, y=fr_sw, color=as.factor(infected)))+
geom_boxplot()+
scale_color_manual(values=c("black", "limegreen", "grey"))+
facet_grid(.~Age)+
theme_bw()
all.data %>%
filter(Sex == "F")%>%
ggplot(aes(x=Time_treatment, y=fr_sw, color=as.factor(infected)))+
geom_boxplot()+
scale_color_manual(values=c("black", "limegreen", "yellow"))+
facet_grid(.~Age)+
theme_bw()
as.factor(all.data$infected)
all.data %>%
filter(Sex == "F")%>%
ggplot(aes(x=Time_treatment, y=fr_sw, color=infected))+
geom_boxplot()+
scale_color_manual(values=c("black", "limegreen", "yellow"))+
facet_grid(.~Age)+
theme_bw()
summary(po_model<-glm(Corrected_Change ~ as.factor(Age) + Phase -1, data=po, family=Gamma))
plot(po)
plot(po_model)
summary(po_model<-glm(Corrected_Change ~ as.factor(Age) + Phase, data=po, family=Gamma))
summary(po_model<-glm(Corrected_Change ~ as.factor(Age)*Phase, data=po, family=Gamma))
summary(po_model<-glm(Corrected_Change ~ Phase, data=po, family=Gamma))
summary(po_model<-glm(Corrected_Change ~ Phase*as.factor(Age), data=po, family=Gamma))
summary(po_model<-glm(Corrected_Change ~ Phase*as.factor(Age), data=po, family=Gamma))
summary(po_model<-glm(Corrected_Change ~ Phase+as.factor(Age), data=po, family=Gamma))
summary(po_model<-glm(Corrected_Change ~ Phase*as.factor(Age), data=po))
plot(po_model)
newdata<-expand.grid(Phase=c("Active", "Resting"), Age = 6:9)
View(newdata)
newdata$preds<-predict(po_model, newdata=newdata)
View(newdata)
newdata %>%
ggplot()+
geom_line(aes(x=Age, y=preds, color=Phase))+
geom_point(po, mapping=aes(x=Age, y=Corrected_Change, color=Phase), alpha = 0.5)
newdata %>%
ggplot()+
geom_smooth(aes(x=Age, y=preds, color=Phase))+
geom_point(po, mapping=aes(x=Age, y=Corrected_Change, color=Phase), alpha = 0.5)
newdata %>%
ggplot()+
geom_line(aes(x=Age, y=preds, color=Phase))+
geom_point(po, mapping=aes(x=Age, y=Corrected_Change, color=Phase), alpha = 0.5)
View(newdata)
summary(po_model<-glm(Corrected_Change ~ Phase*as.factor(Age), data=po))
summary(po_model<-glm(Corrected_Change ~ Phase+as.factor(Age), data=po))
plot(po_model)
newdata<-expand.grid(Phase=c("Active", "Resting"), Age = 6:9)
newdata$preds<-predict(po_model, newdata=newdata)
newdata %>%
ggplot()+
geom_line(aes(x=Age, y=preds, color=Phase))+
geom_point(po, mapping=aes(x=Age, y=Corrected_Change, color=Phase), alpha = 0.5)
View(newdata)
plot(po_model)
summary(po_model<-glm(Corrected_Change ~ Phase+as.factor(Age), data=po))
summary(po_model<-glm(Corrected_Change ~ Phase*as.factor(Age), data=po))
prev <- all.data %>%
filter(Exposed.Control == Exposed) %>%
group_by(Age, Time_treatment) %>%
summarise(inf = sum(infected, na.rm=T),
n = length(Animal),
prev = inf/n)
prev <- all.data %>%
filter(Exposed.Control == "Exposed") %>%
group_by(Age, Time_treatment) %>%
summarise(inf = sum(infected, na.rm=T),
n = length(Animal),
prev = inf/n)
View(prev)
prev <- all.data %>%
filter(Exposed.Control == "Exposed") %>%
group_by(Age, Time_treatment) %>%
summarise(inf = sum(infected, na.rm=T),
n = length(infected, na.rm=T),
prev = inf/n)
prev <- all.data %>%
filter(Exposed.Control == "Exposed") %>%
group_by(Age, Time_treatment) %>%
summarise(inf = sum(infected, na.rm=T),
n = length(infected),
prev = inf/n)
View(prev)
prev <- all.data %>%
filter(Exposed.Control == "Exposed") %>%
group_by(Age, Time_treatment) %>%
summarise(inf = sum(infected, na.rm=T),
n = n(),
prev = inf/n)
View(prev)
prev <- all.data %>%
filter(Exposed.Control == "Exposed") %>%
group_by(Age, Time_treatment) %>%
summarise(inf = sum(infected, na.rm=T),
n = length(infected),
prev = inf/n)
View(prev)
summary(inf_model<-glm(infected ~ as.factor(Age)*Time_treatment,
family = binomial,
data=filter(all.data, Exposed.Control == "Exposed")))
summary(inf_model<-glm(infected ~ Age*Time_treatment,
family = binomial,
data=filter(all.data, Exposed.Control == "Exposed")))
summary(inf_model<-glm(infected ~ Age*Time_treatment,
family = quasibinomial,
data=filter(all.data, Exposed.Control == "Exposed")))
summary(inf_model<-glm(infected ~ Age*Time_treatment,
family = binomial,
data=filter(all.data, Exposed.Control == "Exposed")))
#Does
spore_model<-glm(spore_counts ~ Age*Time_treatment, family = poisson(), data=all.data)
#Does
summary(spore_model<-glm(spore_counts ~ Age*Time_treatment, family = poisson(), data=all.data))
#Does
summary(spore_model<-glm(spore_counts ~ Age*Time_treatment, family = quasipoisson(), data=all.data))
#Does
summary(spore_model<-glm(spore_counts ~ as.factor(Age)*Time_treatment, family = quasipoisson(), data=all.data))
#Does
summary(spore_model<-glm(spore_counts ~ Age*Time_treatment, family = quasipoisson(), data=all.data))
#Does
summary(spore_model<-glm(spore_counts ~ Age*Time_treatment, family = poisson(), data=all.data))
plot(spore_model)
#Does
summary(spore_model<-glm(spore_counts ~ Age*Time_treatment, family = poisson(), data=filter(all.data, infected = 1)))
#Does
summary(spore_model<-glm(spore_counts ~ Age*Time_treatment, family = poisson(), data=filter(all.data, infected == 1)))
#Does
summary(spore_model<-glm(spore_counts ~ as.factor(Age)*Time_treatment, family = poisson(), data=filter(all.data, infected == 1)))
#Does infection prevalence increase with age and night exposure?
summary(inf_model<-glm(infected ~ as.factor(Age)*Time_treatment,
family = binomial,
data=filter(all.data, Exposed.Control == "Exposed")))
#Does infection prevalence increase with age and night exposure?
summary(inf_model<-glm(infected ~ as.factor(Age)+Time_treatment,
family = binomial,
data=filter(all.data, Exposed.Control == "Exposed")))
#Does
summary(spore_model<-glm(spore_counts ~ as.factor(Age) + Time_treatment, family = poisson(), data=filter(all.data, infected == 1)))
#Does
summary(spore_model<-glm(spore_counts ~ as.factor(Age) * Time_treatment, family = poisson(), data=filter(all.data, infected == 1)))
plot(spore_model)
#Does infection intensity increase with Age and night exposure?
summary(spore_model<-glm(spore_counts ~ as.factor(Age) * Time_treatment, family = poisson(), data=filter(all.data, infected == 1)))
library(tidyverse)
library(patchwork)
knitr::opts_chunk$set(echo = TRUE)
feed_data<-read.csv("data/feeding_data_3.28.21.csv", header=T)
po<-read.csv("data/4_Day_PO.csv", header = T) #Corrected_Change is the Active PO per sample (~8 ind. per sample)
po_correct<-read.csv("data/PO_biodare_sample_correction.csv", header = T)
growth<-read.csv("data/growth_data_3.28.21.csv", header=T)
life<-read.csv("data/life_data_3.28.21.csv", header =T)
po %>%
ggplot()+
geom_point(aes(x=Hours_from_Start, y =Corrected_Change, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
geom_smooth(aes(x=Hours_from_Start, y =Corrected_Change), color="black", span=1)+
theme_bw()
po %>%
ggplot(aes(x=Age, y = Corrected_Change, color=Phase))+
geom_point()+
geom_smooth(method="lm")
po %>%
ggplot(aes(x=Age, y = Corrected_Change/8, color=Phase))+
geom_point()+
geom_smooth(method="lm")
po_correct %>%
ggplot()+
geom_point(aes(x=time, y = PO))+
geom_smooth(aes(x=Htime, y = PO), color="black", span=1)+
theme_bw()
po_correct %>%
ggplot()+
geom_point(aes(x=time, y = PO))+
geom_smooth(aes(x=time, y = PO), color="black", span=1)+
theme_bw()
po_correct %>%
ggplot()+
geom_point(aes(x=time, y = PO))+
geom_smooth(aes(x=time, y = PO), color="black", method="lm")+
theme_bw()
po_correct %>%
ggplot()+
geom_point(aes(x=time, y = PO))+
geom_point(aes(x=time, y = PO.1), color="red")
po_correct %>%
ggplot()+
geom_point(aes(x=time, y = PO))+
geom_point(aes(x=time, y = PO.1), color="red")+
geom_smooth(aes(x=time, y = PO), color="black", method="lm")+
geom_smooth(aes(x=time, y = PO.1), color="red", method="lm")+
theme_bw()
po_correct %>%
ggplot()+
geom_point(aes(x=time, y = PO))+
geom_point(aes(x=time, y = PO.1), color="red")+
geom_point(aes(x=time, y = PO.2), color="blue")+
geom_smooth(aes(x=time, y = PO), color="black", method="lm")+
geom_smooth(aes(x=time, y = PO.1), color="red", method="lm")+
geom_smooth(aes(x=time, y = PO.2), color="blue", method="lm")+
theme_bw()
po_correct %>%
ggplot()+
geom_point(aes(x=time, y = PO))+
geom_point(aes(x=time, y = PO.1), color="red")+
geom_point(aes(x=time, y = PO.2), color="blue")+
geom_point(aes(x=time, y = PO.3), color="orange")+
geom_smooth(aes(x=time, y = PO), color="black", method="lm")+
geom_smooth(aes(x=time, y = PO.1), color="red", method="lm")+
geom_smooth(aes(x=time, y = PO.2), color="blue", method="lm")+
geom_smooth(aes(x=time, y = PO.3), color="orange", method="lm")+
theme_bw()
library(tidyverse)
library(patchwork)
knitr::opts_chunk$set(echo = TRUE)
feed_data<-read.csv("data/feeding_data_3.28.21.csv", header=T)
po<-read.csv("data/4_Day_PO.csv", header = T) #Corrected_Change is the Active PO per sample (~8 ind. per sample)
po_correct<- # sample number is arbitrary
read_csv("data/PO_biodare_sample_correction.csv") %>%
pivot_longer(cols = 2:5, names_sep = "_",
names_to = c(NA,"sample"), values_to = "PO")
growth<-read.csv("data/growth_data_3.28.21.csv", header=T)
life<-read.csv("data/life_data_3.28.21.csv", header =T)
summary(life)
library(tidyverse)
library(patchwork)
knitr::opts_chunk$set(echo = TRUE)
feed_data<-read.csv("data/feeding_data_3.28.21.csv", header=T)
po<-read.csv("data/4_Day_PO.csv", header = T) #Corrected_Change is the Active PO per sample (~8 ind. per sample)
po_correct<- # sample number is arbitrary
read_csv("data/PO_biodare_sample_correction.csv") %>%
pivot_longer(cols = 2:5, names_sep = "_",
names_to = c(NA,"sample"), values_to = "PO")
growth<-read.csv("data/growth_data_3.28.21.csv", header=T)
life<-read.csv("data/life_data_3.28.21.csv", header =T)
#calculate the mean of the controls for each plate
summary_data <- feed_data %>%
group_by(Plate_Control) %>%
mutate(control_mean = mean(Control_Flour_Reading, na.rm = T)) %>%
select(Plate_Control, control_mean) %>%
distinct() %>% as.data.frame()
#remove extra row
summary_data  <- summary_data[!(summary_data$Plate_Control == ""),]
#match control mean with plate treatment
map = setNames(summary_data$control_mean,summary_data$Plate_Control)
feed_data$control_mean <- map[as.character(feed_data$Plate_Treatment)]
#volume, mL
v = 10
#time, hours
t = 9
##difference in feeding compared to control
k=feed_data$control_mean/feed_data$Flourometry_Reading
##calculate feeding rate (Sarnelle and Wilson)
feed_data$fr_sw <- log(k) * (v/t)
#calculate mean feeding rate per animal (keep rate > 0)
animal_mean <- feed_data %>%
#keep fr_sw values > 0
#filter(fr_sw > 0) %>% #this removes 64 animals...
#group based on these variables
group_by(Time_treatment, Age, Animal, Exposed.Control) %>%
#means based on groups above
summarise(fr_sw = mean(fr_sw, na.rm=TRUE))
#combine feeding rates with life history data
merge(animal_mean, life, by=c("Age", "Time_treatment", "Animal", "Exposed.Control"), keep=TRUE) %>%
mutate(id = paste(Age,
Time_treatment,
Animal,
Exposed.Control,
sep = "_")) %>%
as.data.frame()->all.data
#create id for growth data
growth %>%
mutate(id = paste(Age,
Time_treatment,
Animal,
Exposed.Control,
sep = "_")) %>%
as.data.frame()->growth
View(growth)
library(tidyverse)
library(patchwork)
knitr::opts_chunk$set(echo = TRUE)
feed_data<-read.csv("data/feeding_data_3.28.21.csv", header=T)
po<-read.csv("data/4_Day_PO.csv", header = T) #Corrected_Change is the Active PO per sample (~8 ind. per sample)
po_correct<- # sample number is arbitrary
read_csv("data/PO_biodare_sample_correction.csv") %>%
pivot_longer(cols = 2:5, names_sep = "_",
names_to = c(NA,"sample"), values_to = "PO")
growth<-read.csv("data/growth_data_3.28.21.csv", header=T)
life<-read.csv("data/life_data_3.28.21.csv", header =T)
#calculate the mean of the controls for each plate
summary_data <- feed_data %>%
group_by(Plate_Control) %>%
mutate(control_mean = mean(Control_Flour_Reading, na.rm = T)) %>%
select(Plate_Control, control_mean) %>%
distinct() %>% as.data.frame()
#remove extra row
summary_data  <- summary_data[!(summary_data$Plate_Control == ""),]
#match control mean with plate treatment
map = setNames(summary_data$control_mean,summary_data$Plate_Control)
feed_data$control_mean <- map[as.character(feed_data$Plate_Treatment)]
#volume, mL
v = 10
#time, hours
t = 9
##difference in feeding compared to control
k=feed_data$control_mean/feed_data$Flourometry_Reading
##calculate feeding rate (Sarnelle and Wilson)
feed_data$fr_sw <- log(k) * (v/t)
#calculate mean feeding rate per animal (keep rate > 0)
animal_mean <- feed_data %>%
#keep fr_sw values > 0
#filter(fr_sw > 0) %>% #this removes 64 animals...
#group based on these variables
group_by(Time_treatment, Age, Animal, Exposed.Control) %>%
#means based on groups above
summarise(fr_sw = mean(fr_sw, na.rm=TRUE))
#combine feeding rates with life history data
merge(animal_mean, life, by=c("Age", "Time_treatment", "Animal", "Exposed.Control"), keep=TRUE) %>%
mutate(id = paste(Age,
Time_treatment,
Animal,
Exposed.Control,
sep = "_")) %>%
as.data.frame()->all.data
#create id for growth data
growth %>%
mutate(id = paste(Age,
Time_treatment,
Animal,
Exposed.Control,
sep = "_")) %>%
as.data.frame()->growth
all.data %>%
filter(Sex == "F")%>%
ggplot()+
geom_boxplot(aes(x=as.factor(Age), y=fr_sw, color=Time_treatment))+
scale_color_manual(values=c("goldenrod2", "darkblue"))+
facet_grid(.~Exposed.Control)+
theme_bw()
all.data %>%
filter(Sex == "F")%>%
ggplot()+
geom_jitter(aes(x=Time_treatment, y=fr_sw, color=Exposed.Control))+
scale_color_manual(values=c("black", "limegreen"))+
facet_grid(.~Age)+
theme_bw()
#Does PO differ across a day (Resting = Light hours, Active = dark hours) and across ages?
summary(po_model<-glm(Corrected_Change ~ Phase*as.factor(Age), data=po))
summary(glm(Corrected_Change ~ as.factor(Age), data = po))
summary(glm(Corrected_Change ~ Age, data = po))
plot(glm(Corrected_Change ~ Age, data = po))
summary(lm(Corrected_Change ~ Age, data = po))
summary(lm(Corrected_Change ~ Age, data = po))
plot(lm(Corrected_Change ~ Age, data = po))
summary(lm(Corrected_Change ~ as.factor(Age), data = po))
